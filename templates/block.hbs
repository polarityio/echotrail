<div class="d-flex align-items-center justify-content-end copy-btn-container">
  <button class="btn copy-btn p-action" {{action "copyData"}} title="Copy Information to Clipboard">
    {{fa-icon icon="clipboard" fixedWidth=true}}
  </button>
  <div class="copy-success-message {{if showCopyMessage "visible" "hidden"}}">
    {{fa-icon icon="check" fixedWidth=true class="copy-success-icon"}}
    Copied Information.
  </div>
</div>

<div id={{concat "echotrail-container-" uniqueIdPrefix}}>
  <div class="mb-2">
    <a href="https://www.echotrail.io/insights/search/{{block.entity.value}}">
      View in EchoTrail  {{fa-icon icon="external-link-square" fixedWidth=true class="external-icon"}}
    </a>
  </div>
  {{#if details.message}}
    <div class="p-value p-block">
      {{details.message}}
    </div>
  {{/if}}

  {{#if details.description}}
    <div class="p-value p-block">
      {{details.description}}
    </div>
  {{/if}}
  {{#if details.intel}}
    <div class="mt-1 mb-1">
      <span class="p-action"{{action "toggleLearnMore"}}>
        Learn More
        {{#if block._state.viewMore.learnMore}}
          {{fa-icon icon="chevron-up"}}
        {{else}}
          {{fa-icon icon="chevron-down"}}
        {{/if}}
      </span>
    </div>
    {{#if block._state.viewMore.learnMore}}
      <div class="p-value learn-more">{{details.intel}}</div>
    {{/if}}
  {{/if}}

  {{#if (or details.eps details.rank details.host_prev)}}
    <h1 class="p-title">{{fa-icon icon="info-circle" fixedWidth=true}} Info</h1>
  {{/if}}
  {{#if details.rank}}
    <div>
      <span class="p-key">Execution Rank: </span>
      <span class="p-value">{{details.rank}}</span>
    </div>
  {{/if}}

  {{#if details.host_prev}}
    <div>
      <span class="p-key">Host Prevelence Score: </span>
      <span class="p-value">{{details.host_prev}}</span>
    </div>
  {{/if}}

  {{#if details.eps}}
    <div>
      <span class="p-key">EchoTrail Prevalence Score: </span>
      <span class="p-value">{{details.eps}}</span>
    </div>
  {{/if}}

  {{#if details.paths}}
    <h1 class="p-title">{{fa-icon icon="folder-tree" fixedWidth=true}} Paths</h1>
    {{#each (take (if block._state.viewMore.paths details.paths.length defaultListSize) details.paths) as | path |}}
      <div class="bar d-flex align-items-top justify-content-between" style="background: linear-gradient(to right, #deeec1 {{path.[1]}}%, white {{path.[1]}}%);">
        <div class="p-value">{{path.[0]}}</div>
        <div class="p-footnote ml-1">{{path.[1]}}%</div>
      </div>
    {{/each}}
    {{#if (gt details.paths.length defaultListSize)}}
      <span class="p-action" {{action "viewMore" "paths"}}>
        {{#if block._state.viewMore.paths}}
          view less
          {{fa-icon icon="chevron-up"}}
        {{else}}
          view more
          {{fa-icon icon="chevron-down"}}
        {{/if}}
      </span>
    {{/if}}
  {{/if}}

  {{#if details.parents}}
    <h1 class="p-title">{{fa-icon icon="arrow-to-top" fixedWidth=true}} Parents</h1>
    {{#each (take (if block._state.viewMore.parents details.parents.length defaultListSize) details.parents) as | path |}}
      <div class="bar d-flex align-items-top justify-content-between" style="background: linear-gradient(to right, #deeec1 {{path.[1]}}%, white {{path.[1]}}%);">
        <div class="p-value">{{path.[0]}}</div>
        <div class="p-footnote ml-1">{{path.[1]}}%</div>
      </div>
    {{/each}}
    {{#if (gt details.parents.length defaultListSize)}}
      <span class="p-action" {{action "viewMore" "parents"}}>
        {{#if block._state.viewMore.parents}}
          view less
          {{fa-icon icon="chevron-up"}}
        {{else}}
          view more
          {{fa-icon icon="chevron-down"}}
        {{/if}}
      </span>
    {{/if}}
  {{/if}}

  {{#if details.grandparents}}
    <h1 class="p-title">{{fa-icon icon="arrow-to-top" fixedWidth=true}} Grandparents</h1>
    {{#each (take (if block._state.viewMore.grandparents details.grandparents.length defaultListSize) details.grandparents) as | path |}}
      <div class="bar d-flex align-items-top justify-content-between" style="background: linear-gradient(to right, #deeec1 {{path.[1]}}%, white {{path.[1]}}%);">
        <div class="p-value">{{path.[0]}}</div>
        <div class="p-footnote ml-1">{{path.[1]}}%</div>
      </div>
    {{/each}}
    {{#if (gt details.grandparents.length defaultListSize)}}
      <span class="p-action" {{action "viewMore" "grandparents"}}>
        {{#if block._state.viewMore.grandparents}}
          view less
          {{fa-icon icon="chevron-up"}}
        {{else}}
          view more
          {{fa-icon icon="chevron-down"}}
        {{/if}}
      </span>
    {{/if}}
  {{/if}}

  {{#if details.children}}
    <h1 class="p-title">{{fa-icon icon="arrow-to-bottom" fixedWidth=true}} Children</h1>
    {{#each (take (if block._state.viewMore.children details.children.length defaultListSize) details.children) as | path |}}
      <div class="bar d-flex align-items-top justify-content-between" style="background: linear-gradient(to right, #deeec1 {{path.[1]}}%, white {{path.[1]}}%);">
        <div class="p-value">{{path.[0]}}</div>
        <div class="p-footnote ml-1">{{path.[1]}}%</div>
      </div>
    {{/each}}
    {{#if (gt details.children.length defaultListSize)}}
      <span class="p-action" {{action "viewMore" "children"}}>
        {{#if block._state.viewMore.children}}
          view less
          {{fa-icon icon="chevron-up"}}
        {{else}}
          view more
          {{fa-icon icon="chevron-down"}}
        {{/if}}
      </span>
    {{/if}}
  {{/if}}

  {{#if details.network}}
    <h1 class="p-title">{{fa-icon icon="network-wired" fixedWidth=true}} Network (Ports)</h1>
    {{#each (take (if block._state.viewMore.network details.network.length defaultListSize) details.network) as | path |}}
      <div class="bar d-flex align-items-top justify-content-between" style="background: linear-gradient(to right, #deeec1 {{path.[1]}}%, white {{path.[1]}}%);">
        <div class="p-value">{{path.[0]}}</div>
        <div class="p-footnote ml-1">{{path.[1]}}%</div>
      </div>
    {{/each}}
    {{#if (gt details.network.length defaultListSize)}}
      <span class="p-action" {{action "viewMore" "network"}}>
        {{#if block._state.viewMore.network}}
          view less
          {{fa-icon icon="chevron-up"}}
        {{else}}
          view more
          {{fa-icon icon="chevron-down"}}
        {{/if}}
      </span>
    {{/if}}
  {{/if}}

  {{#if details.files}}
    <h1 class="p-title">{{fa-icon icon="file" fixedWidth=true}} Files</h1>
    {{#each (take (if block._state.viewMore.files details.files.length defaultListSize) details.files) as | path |}}
      <div class="bar d-flex align-items-top justify-content-between" style="background: linear-gradient(to right, #deeec1 {{path.[1]}}%, white {{path.[1]}}%);">
        <div class="p-value">{{path.[0]}}</div>
        <div class="p-footnote ml-1">{{path.[1]}}%</div>
      </div>
    {{/each}}
    {{#if (gt details.files.length defaultListSize)}}
      <span class="p-action" {{action "viewMore" "files"}}>
        {{#if block._state.viewMore.files}}
          view less
          {{fa-icon icon="chevron-up"}}
        {{else}}
          view more
          {{fa-icon icon="chevron-down"}}
        {{/if}}
      </span>
    {{/if}}
  {{/if}}

  {{#if details.hashes}}
    <h1 class="p-title">{{fa-icon icon="hashtag" fixedWidth=true}} Hashes</h1>
    {{#each (take (if block._state.viewMore.hashes details.hashes.length defaultListSize) details.hashes) as | path |}}
      <div class="bar d-flex align-items-top justify-content-between" style="background: linear-gradient(to right, #deeec1 {{path.[1]}}%, white {{path.[1]}}%);">
        <div class="p-value">{{path.[0]}}</div>
        <div class="p-footnote ml-1">{{path.[1]}}%</div>
      </div>
    {{/each}}
    {{#if (gt details.hashes.length defaultListSize)}}
      <span class="p-action" {{action "viewMore" "hashes"}}>
        {{#if block._state.viewMore.hashes}}
          view less
          {{fa-icon icon="chevron-up"}}
        {{else}}
          view more
          {{fa-icon icon="chevron-down"}}
        {{/if}}
      </span>
    {{/if}}
  {{/if}}
</div>